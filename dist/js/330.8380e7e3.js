"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[330],{3330:function(t,e,r){r.r(e),r.d(e,{default:function(){return n}});var s=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"50%",margin:"10px auto"}},[e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-button",{on:{click:function(e){return t.$router.back()}}},[e("i",{staticClass:"el-icon-back"}),t._v(" 返回")])],1),e("div",{staticClass:"card"},[e("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:t.form,"label-width":"120px",rules:t.rules}},[e("div",{staticStyle:{"text-align":"center","font-size":"24px",margin:"30px 0"}},[t._v("发布商品")]),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"商品图片",prop:"img"}},[e("el-upload",{attrs:{action:t.$baseUrl+"/files/upload",headers:{token:t.user.token},"list-type":"picture","on-success":t.handleImgSuccess}},[e("el-button",{attrs:{type:"primary"}},[t._v("上传图片")])],1)],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"分类",prop:"category"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.categoryList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1)],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"价格",prop:"price"}},[e("el-input",{attrs:{placeholder:"价格"},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"发货地址",prop:"address"}},[e("el-input",{attrs:{placeholder:"发货地址"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"上架状态",prop:"saleStatus"}},[e("el-radio-group",{model:{value:t.form.saleStatus,callback:function(e){t.$set(t.form,"saleStatus",e)},expression:"form.saleStatus"}},[e("el-radio",{attrs:{label:"上架"}}),e("el-radio",{attrs:{label:"下架"}})],1)],1),e("el-form-item",{staticStyle:{"margin-top":"30px"},attrs:{label:"详情",prop:"content"}},[e("div",{attrs:{id:"editor"}})]),e("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[e("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.save}},[t._v("确认发布")])],1)],1)],1)])},a=[],i=(r(7658),r(7438)),o=r.n(i),l={name:"AddGoods",data(){return{id:this.$route.query.id,user:JSON.parse(localStorage.getItem("xm-user")||"{}"),categoryList:[],form:{saleStatus:"上架"},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],category:[{required:!0,message:"请选择商品分类",trigger:"blur"}],address:[{required:!0,message:"请输入发货地址",trigger:"blur"}]},editor:null}},mounted(){this.loadCategory(),this.loadGoods()},methods:{loadGoods(){this.id?this.$request.get("/goods/selectById/"+this.id).then((t=>{"200"==t.code?(this.form=t.data||{},this.setRichText(this.form.content)):this.$message.error(t.msg)})):this.setRichText("")},loadCategory(){this.$request.get("/category/selectAll").then((t=>{"200"==t.code&&(this.categoryList=t.data||[])}))},save(){this.$refs.formRef.validate((t=>{t&&(this.form.content=this.editor.txt.html(),this.$request({url:this.form.id?"/goods/update":"/goods/add",method:this.form.id?"PUT":"POST",data:this.form}).then((t=>{"200"===t.code?(this.$message.success("发布成功"),this.$router.push("/front/goods")):this.$message.error(t.msg)})))}))},handleImgSuccess(t,e,r){this.form.img=t.data},setRichText(t){this.$nextTick((()=>{this.editor=new(o())("#editor"),this.editor.config.placeholder="请输入内容",this.editor.config.uploadImgServer=this.$baseUrl+"/files/editor/upload",this.editor.config.uploadFileName="file",this.editor.config.uploadImgHeaders={token:this.user.token},this.editor.config.uploadImgParams={type:"img"},this.editor.create(),this.editor.txt.html(t)}))}}},d=l,m=r(3736),c=(0,m.Z)(d,s,a,!1,null,"520d1038",null),n=c.exports}}]);
//# sourceMappingURL=330.8380e7e3.js.map