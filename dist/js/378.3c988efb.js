"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[378],{2356:function(t,e,s){s.d(e,{Z:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{"margin-bottom":"20px","font-size":"22px","font-weight":"bold"}},[t._v("评论 "+t._s(t.commentCount))]),e("div",{staticStyle:{"margin-bottom":"20px"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入评论"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(null)}}},[t._v("评论")])],1)],1),e("div",[t._l(t.commentList,(function(s){return e("div",{key:s.id,staticStyle:{"margin-bottom":"20px"}},[e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:s.userAvatar,alt:""}}),e("div",{staticStyle:{"padding-left":"15px",flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px",color:"#666"}},[t._v(t._s(s.userName))]),e("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(s.content))]),e("div",{staticStyle:{color:"#666","font-size":"13px","margin-bottom":"5px"}},[e("span",[t._v(t._s(s.time))]),e("span",{class:{"comment-active":s.showReply},staticStyle:{margin:"0 20px",cursor:"pointer"},on:{click:function(e){return t.handleShowReply(s)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("回复")]),s.userId===t.user.id?e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delComment(s.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),s.showReply?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复"},model:{value:s.replyContent,callback:function(e){t.$set(s,"replyContent",e)},expression:"item.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(s)}}},[t._v("回复")])],1)],1):t._e()])]),s.children?e("div",{staticStyle:{"padding-left":"65px"}},t._l(s.children,(function(i){return e("div",{key:i.id,staticStyle:{display:"flex","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:i.userAvatar,alt:""}}),e("div",{staticStyle:{"padding-left":"15px",flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px",color:"#666"}},[t._v(t._s(i.userName)+" "),i.parentName!==s.userName?e("span",[t._v("回复："+t._s(i.parentName))]):t._e()]),e("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(i.content))]),e("div",{staticStyle:{color:"#666","font-size":"13px","margin-bottom":"5px"}},[e("span",[t._v(t._s(i.time))]),e("span",{class:{"comment-active":i.showReply},staticStyle:{margin:"0 20px",cursor:"pointer"},on:{click:function(e){return t.handleShowReply(i)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("回复")]),i.userId===t.user.id?e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delComment(i.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),i.showReply?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复"},model:{value:i.replyContent,callback:function(e){t.$set(i,"replyContent",e)},expression:"sub.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addComment(i)}}},[t._v("回复")])],1)],1):t._e()])])})),0):t._e()])})),t.total>0?e("div",{staticStyle:{"margin-top":"10px"}},[e("el-pagination",{attrs:{small:"",background:"","current-page":t.pageNum,"page-sizes":[5,10,20],"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],2)])},o=[],a={name:"Comment",props:{fid:null,module:null},data(){return{user:JSON.parse(localStorage.getItem("xm-user")||"{}"),commentCount:0,content:"",commentList:[],pageNum:1,pageSize:5,total:0}},created(){this.loadComment()},methods:{handleShowReply(t){this.$set(t,"showReply",!t.showReply)},delComment(t){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/comment/delete/"+t).then((t=>{"200"===t.code?(this.$message.success("删除成功"),this.loadComment()):this.$message.error(t.msg)}))})).catch((()=>{}))},loadComment(){this.$request.get("/comment/selectTree/"+this.fid+"/"+this.module,{params:{pageNum:this.pageNum,pageSize:this.pageSize}}).then((t=>{"200"==t.code?(this.commentList=t.data?.list||[],this.total=t.data?.total||0):this.$message.error(t.msg)})),this.$request.get("/comment/selectCount/"+this.fid+"/"+this.module).then((t=>{"200"==t.code?this.commentCount=t.data||0:this.$message.error(t.msg)}))},addComment(t){let e={fid:this.fid,userId:this.user.id,module:this.module,content:this.content};t&&(e.content=t.replyContent,e.pid=t.id),e.content?this.$request.post("/comment/add",e).then((t=>{"200"===t.code?(this.$message.success("操作成功"),this.content="",this.loadComment()):this.$message.error(t.msg)})):this.$message.warning("请输入内容!")},handleCurrentChange(t){this.pageNum=t,this.loadComment()}}},n=a,r=s(3736),l=(0,r.Z)(n,i,o,!1,null,"74c55f68",null),d=l.exports},9378:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{margin:"10px auto",padding:"10px 0",width:"50%"}},[e("div",{staticStyle:{display:"flex","margin-bottom":"40px",gap:"20px"}},[e("img",{staticStyle:{width:"50%",height:"400px",display:"block","border-radius":"5px"},attrs:{src:t.goods.img,alt:""}}),e("div",{staticStyle:{flex:"1",width:"0"}},[e("el-tooltip",{attrs:{content:t.goods.name,placement:"top-start"}},[e("div",{staticClass:"line1",staticStyle:{"font-weight":"bold","font-size":"18px",margin:"20px auto"}},[t._v(t._s(t.goods.name))])]),e("div",{staticStyle:{display:"flex","font-size":"16px"}},[e("div",[e("span",{staticStyle:{color:"#666"}},[t._v("浏览")]),t._v(" "+t._s(t.goods.readCount))]),e("div",{staticStyle:{"margin-left":"30px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("点赞")]),t._v(" "+t._s(t.goods.likesCount))]),e("div",{staticStyle:{"margin-left":"30px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("收藏")]),t._v(" "+t._s(t.goods.collectCount))])]),e("div",{staticStyle:{color:"red","font-size":"24px","font-weight":"bold",margin:"40px 0"}},[t._v("￥ "+t._s(t.goods.price))]),e("div",{staticStyle:{"margin-bottom":"20px","font-size":"15px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("发货地：")]),t._v(" "+t._s(t.goods.address))]),e("div",{staticStyle:{"margin-bottom":"20px","font-size":"15px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("卖家：")]),t._v(" "+t._s(t.goods.userName)+" "),e("el-tooltip",{attrs:{effect:"light",content:"聊天",placement:"right","hide-after":2e3}},[e("i",{staticClass:"el-icon-chat-dot-round",staticStyle:{"font-size":"18px","margin-left":"3px",cursor:"pointer"},on:{click:function(e){return t.chat(t.goods.userId)}}})])],1),e("div",{staticStyle:{"margin-bottom":"40px","font-size":"15px"}},[e("span",{staticStyle:{color:"#666"}},[t._v("发布日期：")]),t._v(" "+t._s(t.goods.date))]),e("div",[t.goods.userLikes?t._e():e("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(e){return t.likes(1)}}},[t._v("点赞")]),t.goods.userLikes?e("el-button",{attrs:{size:"medium",type:"warning"},on:{click:function(e){return t.likes(0)}}},[t._v("已点赞")]):t._e(),t.goods.userCollect?t._e():e("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(e){return t.collect(1)}}},[t._v("收藏")]),t.goods.userCollect?e("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(e){return t.collect(0)}}},[t._v("已收藏")]):t._e(),e("el-button",{attrs:{size:"medium",type:"success"},on:{click:t.buy}},[t._v("立即购买")])],1)],1)]),e("div",[e("div",{staticStyle:{display:"flex","border-bottom":"1px solid orange","margin-bottom":"10px"}},[e("div",{class:{active:"商品详情"==t.current},staticStyle:{padding:"10px 20px",cursor:"pointer"},on:{click:function(e){return t.changeItem("商品详情")}}},[t._v("商品详情 ")]),e("div",{class:{active:"商品评论"==t.current},staticStyle:{padding:"10px 20px",cursor:"pointer"},on:{click:function(e){return t.changeItem("商品评论")}}},[t._v("商品评论 ")])]),"商品详情"==t.current?e("div",[e("div",{domProps:{innerHTML:t._s(t.goods.content)}})]):e("div",[e("Comment",{attrs:{fid:t.id,module:"goods"}})],1)]),e("el-dialog",{attrs:{title:"请选择收货地址",visible:t.dialogVisible,width:"30%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticStyle:{padding:"0 20px"}},[e("el-radio-group",{model:{value:t.form.addressId,callback:function(e){t.$set(t.form,"addressId",e)},expression:"form.addressId"}},t._l(t.addressList,(function(s){return e("el-radio",{key:s.id,staticStyle:{"margin-bottom":"15px"},attrs:{label:s.id}},[t._v(" "+t._s(s.name+"-"+s.address+"-"+s.phone)+" ")])})),1),0==t.addressList.length?e("a",{attrs:{href:"/front/address",target:"_blank"}},[t._v("还没有收货地址？去创建")]):t._e()],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.addOrder}},[t._v("提交订单")])],1)])],1)},o=[],a=(s(7658),s(2356)),n={components:{Comment:a.Z},data(){return{user:JSON.parse(localStorage.getItem("xm-user")||"{}"),id:this.$route.query.id,goods:{},current:"商品详情",dialogVisible:!1,addressList:[],form:{}}},created(){this.$request.put("/goods/updateReadCount/"+this.id).then((t=>{this.loadGoods()})),this.loadAddress()},methods:{chat(t){this.$request.post("/chatGroup/add",{chatUserId:t,userId:this.user.id}).then((t=>{this.$router.push("/front/chat")}))},addOrder(){this.form.addressId?(this.form.goodsId=this.id,this.$request.post("/orders/add",this.form).then((t=>{"200"==t.code?(this.$message.success("下单成功"),this.dialogVisible=!1,this.$router.push("/front/orders")):this.$message.error(t.msg)}))):this.$message.warning("请选择收货地址")},buy(){this.dialogVisible=!0},loadAddress(){this.$request.get("/address/selectAll").then((t=>{"200"==t.code?this.addressList=t.data:this.$message.error(t.msg)}))},loadGoods(){this.$request.get("/goods/selectById/"+this.id).then((t=>{"200"==t.code?this.goods=t.data:this.$message.error(t.msg)}))},changeItem(t){this.current=t},likes(t){let e={goodsId:this.id,module:"goods"};this.$request.post("/likes/add",e).then((e=>{"200"==e.code?(1==t?this.$message.success("点赞成功"):this.$message.success("已取消点赞"),this.loadGoods()):this.$message.error(e.msg)}))},collect(t){let e={goodsId:this.id,module:"goods"};this.$request.post("/collect/add",e).then((e=>{"200"==e.code?(t?this.$message.success("收藏成功"):this.$message.success("已取消收藏"),this.loadGoods()):this.$message.error(e.msg)}))}}},r=n,l=s(3736),d=(0,l.Z)(r,i,o,!1,null,null,null),c=d.exports}}]);
//# sourceMappingURL=378.3c988efb.js.map